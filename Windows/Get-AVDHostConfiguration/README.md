
# Get-AVDHostConfiguration Script

**Author:** Brandon Cook
**Version:** 1.0
**Date:** June 6, 2025

## Description

This PowerShell script is a comprehensive tool designed to capture a detailed snapshot of an Azure Virtual Desktop (AVD) session host's configuration. Its primary purpose is to generate documentation that can be used for:

* Migrating a session host from Windows 10 to Windows 11.
* Creating a baseline for a "golden image."
* Troubleshooting environmental inconsistencies.
* Auditing system configurations.

The script exports a wide range of system data into individual files and then compiles them into a single, professional, and interactive HTML report.

## Key Features

* **Comprehensive Data Capture:** Gathers information from over 20 key areas, including system info, installed software, networking, firewall rules, FSLogix settings, GPOs, printers, and more.
* **Interactive HTML Report:** Generates a single, easy-to-navigate HTML file with a floating table of contents and collapsible sections for organized review.
* **Robust Data Export:** Uses CSV and raw text files for all exported data, ensuring no information is truncated. The original export files are kept alongside the HTML report.
* **Transcript Logging:** Automatically creates a complete execution log (`_ScriptRun.log`) for auditing and troubleshooting purposes.
* **Dynamic Naming:** The final HTML report is automatically named with the host's name and the current date (e.g., `AVD Migration Report - HOSTNAME - 2025-06-06.html`).
* **Flexible & Reusable:** The output directory can be specified using a script parameter.

## Prerequisites

1.  **PowerShell 5.1 or later.**
2.  **Run as Administrator:** The script must be run from an elevated PowerShell session to access all necessary system information (especially for GPOs, services, and registry keys).
3.  **Group Policy Management Tools (for GPO Reporting):** For the primary method of GPO reporting (`Get-GPResultantSetOfPolicy`) to work, this feature should be installed. If it is not present, the script will automatically fall back to using the older `gpresult.exe` tool.
    * To install the feature, run the following command once in an elevated PowerShell window:
        ```powershell
        Add-WindowsCapability -Online -Name 'Rsat.GroupPolicy.Management.Tools~~~~0.0.1.0'
        ```

## Usage Instructions

1.  Save the script as `Get-AVDHostConfiguration.ps1`.
2.  Open a PowerShell console **as an Administrator**.
3.  Navigate to the directory where you saved the script.
    ```powershell
    cd "C:\Path\To\Your\Scripts"
    ```
4.  Execute the script.

    * **To run with the default output location (`C:\AVD_Migration_Export`):**
        ```powershell
        .\Get-AVDHostConfiguration.ps1
        ```
    * **To specify a custom output location:**
        ```powershell
        .\Get-AVDHostConfiguration.ps1 -OutputDir "C:\Temp\ClientExport"
        ```

## Output

After the script finishes, a new folder will be created at the specified output location. This folder will contain:

* **Individual Data Files:** A collection of `.txt`, `.csv`, and `.reg` files, each containing specific configuration data.
* **`GPResult.html`:** The detailed Resultant Set of Policy report generated by the system.
* **`_ScriptRun.log`:** A full transcript of the script's execution from start to finish.
* **`AVD Migration Report - [HOSTNAME] - [DATE].html`:** The main, interactive HTML summary report that organizes and presents all the collected data. This is the primary file to review.

## HTML Report Structure

The main HTML report is organized into the following collapsible sections for easy review:

* Execution Summary
* System & OS
* Identity & Security
* Installed Software & Services
* AVD, FSLogix & App Config
* Networking & Firewall
* Automation & Peripherals
* Storage

You can use the floating navigation menu on the left to quickly jump to any section.

⭐ **Star this repository if it helped you with collecting AVD Host Configuration Information!** ⭐

**Made with ❤️ for the Windows administration community**
